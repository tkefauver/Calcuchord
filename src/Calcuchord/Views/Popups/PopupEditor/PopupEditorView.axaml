<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignWidth="800"
             d:DesignHeight="450"
             xmlns:sys="clr-namespace:System;assembly=netstandard"
             xmlns:avalonia="clr-namespace:Material.Icons.Avalonia;assembly=Material.Icons.Avalonia"
             xmlns:controls="clr-namespace:Material.Styles.Controls;assembly=Material.Styles"
             xmlns:dialogHostAvalonia="clr-namespace:DialogHostAvalonia;assembly=DialogHost.Avalonia"
             xmlns:local="clr-namespace:Calcuchord"
             xmlns:common="clr-namespace:MonkeyPaste.Common.Avalonia;assembly=MonkeyPaste.Common.Avalonia"
             x:DataType="local:InstrumentViewModel"
             x:Class="Calcuchord.PopupEditorView">
    <UserControl.Styles>
        <Style Selector=":is(TextBox) /template/ Panel#PART_TextContainer">
            <Setter Property="Margin"
                    Value="0" />
            <Setter Property="VerticalAlignment"
                    Value="Center" />
        </Style>
        <Style Selector="TextBlock.tab-header">
            <Setter Property="Foreground"
                    Value="{DynamicResource Fg}" />
            <Setter Property="FontSize"
                    Value="24" />
            <Setter Property="TextAlignment"
                    Value="Center" />
        </Style>
        <Style Selector="TabItem:selected TextBlock.tab-header">
            <Setter Property="Foreground"
                    Value="{DynamicResource Bg}" />
        </Style>

        <Style Selector="TabItem:disabled TextBlock.tab-header">
            <Setter Property="Foreground"
                    Value="{DynamicResource DisabledAccentFg}" />
            <Setter Property="FontStyle"
                    Value="Italic" />
        </Style>
        <Style Selector=":is(Button).float-text">
            <Setter Property="Foreground"
                    Value="{DynamicResource Bg}" />
        </Style>
        <Style Selector=":is(Button).float-text TextBlock">
            <Setter Property="Foreground"
                    Value="{DynamicResource Bg}" />
        </Style>
        <Style Selector="TabItem > ScrollViewer">
            <Setter Property="Margin"
                    Value="0,30,0,0" />
        </Style>

        <Style Selector="controls|ColorZone#PopupZone">
            <Setter Property="MinWidth"
                    Value="300" />
            <Setter Property="Height"
                    Value="500" />
        </Style>

        <Style
            Selector="controls|ColorZone#PopupZone.welcome, controls|ColorZone#PopupZone.welcome2, controls|ColorZone#PopupZone.progress, controls|ColorZone#PopupZone.intro-progress">
            <Setter Property="Height"
                    Value="{x:Static sys:Double.NaN}" />
        </Style>

        <Style
            Selector="controls|ColorZone#PopupZone.intro-progress DockPanel#InstDockPanel, controls|ColorZone#PopupZone.welcome DockPanel#InstDockPanel, controls|ColorZone#PopupZone.welcome2 DockPanel#InstDockPanel, controls|ColorZone#PopupZone.progress DockPanel#InstDockPanel">
            <Setter Property="IsVisible"
                    Value="False" />
        </Style>
        <Style Selector="controls|ColorZone#PopupZone:not(.progress) local|TuningGenProgressView">
            <Setter Property="IsVisible"
                    Value="False" />
        </Style>
        <Style Selector="controls|ColorZone#PopupZone:not(.welcome) local|WelcomeView">
            <Setter Property="IsVisible"
                    Value="False" />
        </Style>
        <Style Selector="controls|ColorZone#PopupZone:not(.welcome2) local|WelcomeView2">
            <Setter Property="IsVisible"
                    Value="False" />
        </Style>
    </UserControl.Styles>


    <Border x:Name="PopupOverlayBorder">
        <Border.Background>
            <SolidColorBrush Color="Black"
                             Opacity="0.7" />
        </Border.Background>
        <Grid>

            <controls:ColorZone x:Name="PopupZone"
                                Classes.progress="{Binding CurGenTuning, Converter={x:Static ObjectConverters.IsNotNull}}"
                                Classes.welcome="{Binding IsShowingWelcome, Source={x:Static local:MainViewModel.Instance}}"
                                Classes.welcome2="{Binding IsShowingWelcome2, Source={x:Static local:MainViewModel.Instance}}"
                                Classes.intro-progress="{Binding IsShowingIntroProgress, Source={x:Static local:MainViewModel.Instance}}"
                                Mode="Accent"
                                CornerRadius="10"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Margin="20"
                                BorderBrush="{DynamicResource Bg}"
                                Foreground="{DynamicResource Bg}"
                                BorderThickness="5"
                                Padding="10">
                <Grid>
                    <DockPanel x:Name="InstDockPanel">
                        <!-- NAV -->
                        <UniformGrid DockPanel.Dock="Bottom"
                                     Columns="2"
                                     x:DataType="local:MainViewModel"
                                     DataContext="{x:Static local:MainViewModel.Instance}">
                            <Button HorizontalAlignment="Left"
                                    VerticalAlignment="Bottom"
                                    Classes="float-text"
                                    IsHitTestVisible="{Binding !IsDoingIntro}"
                                    Opacity="{Binding IsDoingIntro, ConverterParameter=0|1, Converter={x:Static common:MpAvBoolToDoubleConverter.Instance}}"
                                    Command="{Binding CancelEditInstrumentCommand}">
                                <Button.Resources>
                                    <SolidColorBrush x:Key="MaterialPrimaryMidBrush">Red</SolidColorBrush>
                                    <SolidColorBrush x:Key="MaterialPrimaryMidForegroundBrush">White</SolidColorBrush>
                                </Button.Resources>
                                <TextBlock FontSize="18"
                                           Text="Cancel" />
                            </Button>
                            <Button HorizontalAlignment="Right"
                                    VerticalAlignment="Bottom"
                                    Classes="float-text dark"
                                    Command="{Binding FinishEditInstrumentCommand}">
                                <TextBlock FontSize="18"
                                           Text="Done" />
                            </Button>
                        </UniformGrid>

                        <!-- TABS -->
                        <TabControl>
                            <TabControl.Items>
                                <TabItem IsSelected="{Binding IsInstrumentTabSelected, Mode=TwoWay}">
                                    <TabItem.Header>
                                        <TextBlock Classes="tab-header"
                                                   Text="Instrument" />
                                    </TabItem.Header>
                                    <ScrollViewer Margin="0,20,0,20">
                                        <local:InstrumentEditorView Margin="0,0,20,0" />
                                    </ScrollViewer>
                                </TabItem>
                                <TabItem IsSelected="{Binding IsTuningTabSelected, Mode=TwoWay}"
                                         IsEnabled="{Binding CanEditTunings}">
                                    <TabItem.Header>
                                        <TextBlock Classes="tab-header"
                                                   Text="Tunings" />
                                    </TabItem.Header>

                                    <local:TuningEditorView />
                                </TabItem>
                            </TabControl.Items>
                        </TabControl>
                    </DockPanel>

                    <local:TuningGenProgressView x:Name="ProgressView"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Center"
                                                 Foreground="{DynamicResource Bg}"
                                                 DataContext="{Binding CurGenTuning}" />

                    <local:WelcomeView HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource Bg}" />

                    <local:WelcomeView2 HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource Bg}" />
                </Grid>

            </controls:ColorZone>

        </Grid>

    </Border>

</UserControl>